{
  "name" : "Transform NYC Taxi Trip Data",
  "description" : "",
  "role" : "arn:aws:iam::721835714886:role/AWSGlueServiceRole-SDL-Jumpstart",
  "executionProperty" : {
    "maxConcurrentRuns" : 1
  },
  "command" : {
    "name" : "glueetl",
    "scriptLocation" : "s3://aws-glue-assets-721835714886-ap-south-1/scripts/Transform NYC Taxi Trip Data.py",
    "pythonVersion" : "3"
  },
  "defaultArguments" : {
    "--enable-metrics" : "true",
    "--enable-spark-ui" : "true",
    "--spark-event-logs-path" : "s3://aws-glue-assets-721835714886-ap-south-1/sparkHistoryLogs/",
    "--enable-job-insights" : "true",
    "--enable-glue-datacatalog" : "true",
    "--enable-continuous-cloudwatch-log" : "true",
    "--job-bookmark-option" : "job-bookmark-enable",
    "--job-language" : "python",
    "--TempDir" : "s3://aws-glue-assets-721835714886-ap-south-1/temporary/"
  },
  "maxRetries" : 3,
  "allocatedCapacity" : 10,
  "timeout" : 2880,
  "maxCapacity" : 10.0,
  "glueVersion" : "3.0",
  "numberOfWorkers" : 10,
  "workerType" : "G.1X",
  "executionClass" : "STANDARD",
  "codeGenConfigurationNodes" : "{\"node-1672573464108\":{\"Join\":{\"Columns\":[{\"From\":\"node-1672572737229\",\"Keys\":[[\"pu_location_id\"]]},{\"From\":\"node-1672573270020\",\"Keys\":[[\"do_location_id\"]]}],\"Inputs\":[\"node-1672572737229\",\"node-1672573270020\"],\"JoinType\":\"equijoin\",\"Name\":\"Yellow Trips Data + Pickup Zone Lookup + Dropoff Zone Lookup\"}},\"node-1672571944741\":{\"Filter\":{\"Filters\":[{\"Negated\":false,\"Operation\":\"REGEX\",\"Values\":[{\"Type\":\"CONSTANT\",\"Value\":[\"^2020-1\"]},{\"Type\":\"COLUMNEXTRACTED\",\"Value\":[\"tpep_pickup_datetime\"]}]}],\"Inputs\":[\"node-1672571845268\"],\"LogicalOperator\":\"AND\",\"Name\":\"Filter - Yellow Trip Data\"}},\"node-1672572456969\":{\"S3CatalogSource\":{\"AdditionalOptions\":{},\"Database\":\"nyctaxi_db\",\"Name\":\"Pickup Zone Lookup\",\"PartitionPredicate\":\"\",\"Table\":\"taxi_zone_lookup\"}},\"node-1672573270020\":{\"ApplyMapping\":{\"Inputs\":[\"node-1672573172981\"],\"Mapping\":[{\"Dropped\":false,\"FromPath\":[\"locationid\"],\"FromType\":\"long\",\"ToKey\":\"do_location_id\",\"ToType\":\"long\"},{\"Dropped\":false,\"FromPath\":[\"borough\"],\"FromType\":\"string\",\"ToKey\":\"do_borough\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"zone\"],\"FromType\":\"string\",\"ToKey\":\"do_zone\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"service_zone\"],\"FromType\":\"string\",\"ToKey\":\"do_service_zone \",\"ToType\":\"string\"}],\"Name\":\"ApplyMapping - Dropoff Zone Lookup\"}},\"node-1672575856229\":{\"ApplyMapping\":{\"Inputs\":[\"node-1672573464108\"],\"Mapping\":[{\"Dropped\":false,\"FromPath\":[\"pu_location_id\"],\"FromType\":\"long\",\"ToKey\":\"pu_location_id\",\"ToType\":\"long\"},{\"Dropped\":false,\"FromPath\":[\"pu_borough\"],\"FromType\":\"string\",\"ToKey\":\"pu_borough\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"pu_zone\"],\"FromType\":\"string\",\"ToKey\":\"pu_zone\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"pu_service_zone \"],\"FromType\":\"string\",\"ToKey\":\"pu_service_zone \",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"vendorid\"],\"FromType\":\"long\",\"ToKey\":\"vendor_id\",\"ToType\":\"long\"},{\"Dropped\":false,\"FromPath\":[\"tpep_pickup_datetime\"],\"FromType\":\"string\",\"ToKey\":\"pickup_datetime\",\"ToType\":\"timestamp\"},{\"Dropped\":false,\"FromPath\":[\"tpep_dropoff_datetime\"],\"FromType\":\"string\",\"ToKey\":\"dropoff_datetime\",\"ToType\":\"timestamp\"},{\"Dropped\":false,\"FromPath\":[\"passenger_count\"],\"FromType\":\"long\",\"ToKey\":\"passenger_count\",\"ToType\":\"long\"},{\"Dropped\":false,\"FromPath\":[\"trip_distance\"],\"FromType\":\"double\",\"ToKey\":\"trip_distance\",\"ToType\":\"double\"},{\"Dropped\":false,\"FromPath\":[\"ratecodeid\"],\"FromType\":\"long\",\"ToKey\":\"ratecodeid\",\"ToType\":\"long\"},{\"Dropped\":false,\"FromPath\":[\"store_and_fwd_flag\"],\"FromType\":\"string\",\"ToKey\":\"store_and_fwd_flag\",\"ToType\":\"string\"},{\"Dropped\":true,\"FromPath\":[\"pulocationid\"],\"FromType\":\"long\",\"ToKey\":\"pulocationid\",\"ToType\":\"long\"},{\"Dropped\":true,\"FromPath\":[\"dolocationid\"],\"FromType\":\"long\",\"ToKey\":\"dolocationid\",\"ToType\":\"long\"},{\"Dropped\":false,\"FromPath\":[\"payment_type\"],\"FromType\":\"long\",\"ToKey\":\"payment_type\",\"ToType\":\"long\"},{\"Dropped\":false,\"FromPath\":[\"fare_amount\"],\"FromType\":\"double\",\"ToKey\":\"fare_amount\",\"ToType\":\"double\"},{\"Dropped\":false,\"FromPath\":[\"extra\"],\"FromType\":\"double\",\"ToKey\":\"extra\",\"ToType\":\"double\"},{\"Dropped\":false,\"FromPath\":[\"mta_tax\"],\"FromType\":\"double\",\"ToKey\":\"mta_tax\",\"ToType\":\"double\"},{\"Dropped\":false,\"FromPath\":[\"tip_amount\"],\"FromType\":\"double\",\"ToKey\":\"tip_amount\",\"ToType\":\"double\"},{\"Dropped\":false,\"FromPath\":[\"tolls_amount\"],\"FromType\":\"double\",\"ToKey\":\"tolls_amount\",\"ToType\":\"double\"},{\"Dropped\":false,\"FromPath\":[\"improvement_surcharge\"],\"FromType\":\"double\",\"ToKey\":\"improvement_surcharge\",\"ToType\":\"double\"},{\"Dropped\":false,\"FromPath\":[\"total_amount\"],\"FromType\":\"double\",\"ToKey\":\"total_amount\",\"ToType\":\"double\"},{\"Dropped\":false,\"FromPath\":[\"congestion_surcharge\"],\"FromType\":\"double\",\"ToKey\":\"congestion_surcharge\",\"ToType\":\"double\"},{\"Dropped\":false,\"FromPath\":[\"do_location_id\"],\"FromType\":\"long\",\"ToKey\":\"do_location_id\",\"ToType\":\"long\"},{\"Dropped\":false,\"FromPath\":[\"do_borough\"],\"FromType\":\"string\",\"ToKey\":\"do_borough\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"do_zone\"],\"FromType\":\"string\",\"ToKey\":\"do_zone\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"do_service_zone \"],\"FromType\":\"string\",\"ToKey\":\"do_service_zone \",\"ToType\":\"string\"}],\"Name\":\"ApplyMapping - Joined Data\"}},\"node-1672571845268\":{\"SelectFromCollection\":{\"Index\":0,\"Inputs\":[\"node-1672570129508\"],\"Name\":\"SelectFromCollection\"}},\"node-1672572615541\":{\"ApplyMapping\":{\"Inputs\":[\"node-1672572456969\"],\"Mapping\":[{\"Dropped\":false,\"FromPath\":[\"locationid\"],\"FromType\":\"long\",\"ToKey\":\"pu_location_id\",\"ToType\":\"long\"},{\"Dropped\":false,\"FromPath\":[\"borough\"],\"FromType\":\"string\",\"ToKey\":\"pu_borough\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"zone\"],\"FromType\":\"string\",\"ToKey\":\"pu_zone\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"service_zone\"],\"FromType\":\"string\",\"ToKey\":\"pu_service_zone \",\"ToType\":\"string\"}],\"Name\":\"ApplyMapping - Pickup Zone Lookup\"}},\"node-1672573172981\":{\"S3CatalogSource\":{\"AdditionalOptions\":{},\"Database\":\"nyctaxi_db\",\"Name\":\"Dropoff Zone Lookup\",\"PartitionPredicate\":\"\",\"Table\":\"taxi_zone_lookup\"}},\"node-1672569399435\":{\"S3CatalogSource\":{\"AdditionalOptions\":{},\"Database\":\"nyctaxi_db\",\"Name\":\"Yellow Trip Data\",\"PartitionPredicate\":\"\",\"Table\":\"yellow_tripdata\"}},\"node-1672575996500\":{\"S3GlueParquetTarget\":{\"Compression\":\"snappy\",\"Inputs\":[\"node-1672575856229\"],\"Name\":\"Transformed Yellow Trip Data\",\"PartitionKeys\":[],\"Path\":\"s3://awslearning-transformed/nyc-taxi/yellow-tripdata/\",\"SchemaChangePolicy\":{\"EnableUpdateCatalog\":false}}},\"node-1672570129508\":{\"CustomCode\":{\"ClassName\":\"MyTransform\",\"Code\":\"\\ndf = dfc.select(list(dfc.keys())[0]).toDF().na.drop()\\nresults = DynamicFrame.fromDF(df, glueContext, \\\"results\\\")\\nreturn DynamicFrameCollection({\\\"results\\\": results}, glueContext)   \\n\\n\\n\\n\\n\",\"Inputs\":[\"node-1672569399435\"],\"Name\":\"Remove Records with NULL\"}},\"node-1672572737229\":{\"Join\":{\"Columns\":[{\"From\":\"node-1672572615541\",\"Keys\":[[\"pu_location_id\"]]},{\"From\":\"node-1672571944741\",\"Keys\":[[\"pulocationid\"]]}],\"Inputs\":[\"node-1672572615541\",\"node-1672571944741\"],\"JoinType\":\"equijoin\",\"Name\":\"Yellow Trips Data + Pickup Zone Lookup\"}}}",
  "sourceControlDetails" : {
    "provider" : "GITHUB",
    "repository" : "AWS-Glue",
    "branch" : "main",
    "folder" : "Transform NYC Taxi Trip Data"
  }
}